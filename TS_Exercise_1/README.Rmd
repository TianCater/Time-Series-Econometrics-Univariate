---
title: "README"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r Data Loading and Cleaning}


library(readxl)
DF1 <- read_excel("data/TSexercise1data.xlsx")

#load required packages

pacman::p_load(dplyr,stats,fixest, tidyverse, huxtable, hrbrthemes, modelsummary, glue,forecast)

#Isolate columns as numeric vectors/variables

Spread <- DF1 %>% dplyr::select(spread)
y <- DF1%>% dplyr::select(y)



#VITAL, mutate dates to :Type Date

DF1 <- DF1 %>%
   group_by(dates) %>%
   mutate(dates=as.Date(dates, format = "%Y.%m.%d"))

Date <- DF1 %>% dplyr::select(dates)


```



```{r generating the variables as time series}


TS_spread <- ts(Spread,start=c(1984,1,1),end = c(2001,8,1),frequency = 12)

TS_y <-  ts(y,start=c(1984,1,1),end = c(2001,8,1),frequency = 12)


```



```{r Plot ACF and PACF}

##Plot,ACF and PACF for {Spread}

forecast::tsdisplay(TS_spread)


##Plot,ACF and PACF for {y}

forecast::tsdisplay(TS_y)

```



```{r Investigating and fitting different models for each process}

##{Spread}

###AR(1)

AR1 <- forecast::Arima(TS_spread,c(1,0,0))
plot(TS_spread)
lines(fitted(AR1), col='blue')

###summary
summary(AR1)
```


```{r }
###AR(2)
AR2 <- forecast::Arima(TS_spread,c(2,0,0))
plot(TS_spread)
lines(fitted(AR1), col='blue')

###summary
summary(AR2)
```


```{r }
###MA(2)

MA2 <- forecast::Arima(TS_spread,c(0,0,2))
plot(TS_spread)
lines(fitted(MA2), col='blue')

###summary
summary(MA2)
```


```{r }
###ARMA(1,1)

ARMA11 <- forecast::Arima(TS_spread,c(1,0,1))
plot(TS_spread)
lines(fitted(ARMA11),col='blue')

###summary
summary(ARMA11)
```


```{r }
###ARMA(2,1)

ARMA21 <- forecast::Arima(TS_spread,c(2,0,1))
plot(TS_spread)
lines(fitted(ARMA21),col='blue')

###summary
summary(ARMA21)
```


```{r }
##{y}


###AR(1)
AR1_y <- forecast::Arima(TS_y,c(1,0,0))
plot(TS_y)
lines(fitted(AR1_y), col='blue')

###summary
summary(AR1_y)

```


```{r }
###AR(2)
AR2_y <- forecast::Arima(TS_y,c(2,0,0))
plot(TS_y)
lines(fitted(AR2_y), col='blue')

###summary
summary(AR2_y)


```


```{r}
###MA(2)

MA2_y <- forecast::Arima(TS_y,c(0,0,2))
plot(TS_y)
lines(fitted(MA2_y), col='blue')


###summary
summary(MA2_y)
```


```{r }
###ARMA(1,1)

ARMA11_y <- forecast::Arima(TS_y,c(1,0,1))
plot(TS_y)
lines(fitted(ARMA11_y),col='blue')

###summary
summary(ARMA11_y)
```


```{r }
###ARMA(2,1)

ARMA21_y <- forecast::Arima(TS_y,c(2,0,1))
plot(TS_y)
lines(fitted(ARMA21_y),col='blue')

###summary
summary(ARMA21_y)



```


For the Spread process, the ARMA(1,1) model has the lowest AIC and BIC values (-277.2 and -263.77, respectively)

Fir the y process, the AR(1) model has the lowest AIC and BIC values (205.09 and 215.16, respectively)

We select these models and  evaluate whether they are adequate, i.e is congruent and parsimonious. If the models are adequate, we present the estimated results of the best model and all necessary specification tests. 

```{r}

pacman::p_load(lmtest)

ARMA11 <- forecast::Arima(TS_spread,c(1,0,1))

ARMA11

coeftest(ARMA11)

```


```{r}

Res1 <- forecast::checkresiduals(ARMA11)

pacman::p_load(tseries)

jarque.bera.test(residuals(ARMA11))

```

```{r}

AR1_y <- forecast::Arima(TS_y,c(1,0,0))

AR1_y

coeftest(AR1_y)

```


```{r}

Res2 <- forecast::checkresiduals(AR1_y)

pacman::p_load(tseries)

jarque.bera.test(residuals(AR1_y))

```

